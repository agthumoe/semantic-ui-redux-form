{"version":3,"sources":["../../src/components/AsyncDropdownField.jsx"],"names":["renderField","fields","id","label","className","multiple","search","handleOnSearch","handleOnChange","input","data","meta","touched","error","rest","undefined","event","d","onChange","value","e","v","AsnycDropdownField","validate","isRequired","searchBy","onSearch","onAddNew","keyFieldName","valueFieldName","textFieldName","apiKey","api","headers","Headers","append","newValidator","slice","push","required","setData","loading","setLoading","fetch","then","response","json","_","map","x","key","text","target","propTypes","PropTypes","string","clearable","bool","disabled","fluid","icon","oneOfType","element","name","func","placeholder","readOnly","size","oneOf","arrayOf","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Dropdown, Form } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { Field } from 'redux-form';\nimport _ from 'lodash';\nimport { required } from './validation';\n\nconst renderField = (fields) => {\n  const {\n    id,\n    label,\n    className,\n    multiple,\n    search,\n    handleOnSearch,\n    handleOnChange,\n    input,\n    data,\n    meta: { touched, error },\n    ...rest\n  } = fields;\n\n  return (\n    <Form.Field className={className} error={touched && error && true}>\n      {label && (\n        <label htmlFor={id}>\n          {label}\n          <small>{touched && error ? `* ( ${error} )` : undefined}</small>\n        </label>\n      )}\n      <Dropdown\n        {...rest}\n        onChange={(event, d) => {\n          if (typeof handleOnChange === 'function') {\n            handleOnChange(event, d);\n          }\n          if (multiple) {\n            input.onChange([...d.value]);\n          } else {\n            input.onChange(d.value);\n          }\n        }}\n        onSearchChange={(e, v) => {\n          handleOnSearch(e, v);\n        }}\n        options={data}\n        search={!!search}\n        selection\n        value={input.value}\n      />\n    </Form.Field>\n  );\n};\n\nconst AsnycDropdownField = ({\n  validate,\n  isRequired,\n  search,\n  searchBy,\n  onSearch,\n  onAddNew,\n  onChange,\n  keyFieldName,\n  valueFieldName,\n  textFieldName,\n  apiKey,\n  api,\n  ...rest\n}) => {\n  const headers = new Headers();\n  if (apiKey) {\n    headers.append('Authorization', `Bearer ${apiKey}`);\n  }\n  const newValidator = validate.slice();\n  if (isRequired) {\n    newValidator.push(required);\n  }\n\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    setLoading(true);\n    fetch(api, { headers })\n      .then((response) => response.json())\n      .then((response) => {\n        setLoading(false);\n        setData(\n          _.map(response, (x) => ({\n            key: x[keyFieldName],\n            text: x[textFieldName],\n            value: x[valueFieldName],\n          })),\n        );\n      });\n  }, [keyFieldName, textFieldName, valueFieldName, api]);\n\n  return (\n    <Field\n      {...rest}\n      allowAdditions={typeof onAddNew === 'function'}\n      component={renderField}\n      data={data}\n      handleOnAddNew={onAddNew}\n      handleOnChange={onChange}\n      handleOnSearch={(e, v) => {\n        if (typeof onSearch === 'function') {\n          onSearch(e, v);\n        }\n        if (searchBy && e.target.value) {\n          setLoading(true);\n          fetch(`${api}?${searchBy}=${e.target.value}`, { headers })\n            .then((response) => response.json())\n            .then((response) => {\n              setLoading(false);\n              setData(\n                _.map(response, (x) => ({\n                  key: x[keyFieldName],\n                  text: x[textFieldName],\n                  value: x[valueFieldName],\n                })),\n              );\n            });\n        }\n      }}\n      loading={loading}\n      search={search || searchBy || false}\n      validate={newValidator}\n    />\n  );\n};\n\nAsnycDropdownField.propTypes = {\n  api: PropTypes.string.isRequired,\n  clearable: PropTypes.bool,\n  className: PropTypes.string,\n  disabled: PropTypes.bool,\n  fluid: PropTypes.bool,\n  icon: PropTypes.string,\n  id: PropTypes.string.isRequired,\n  isRequired: PropTypes.bool,\n  keyFieldName: PropTypes.string,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n  multiple: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onAddNew: PropTypes.func,\n  onChange: PropTypes.func,\n  onSearch: PropTypes.func,\n  placeholder: PropTypes.string,\n  readOnly: PropTypes.bool,\n  search: PropTypes.bool,\n  searchBy: PropTypes.string,\n  size: PropTypes.oneOf([\n    'mini',\n    'small',\n    'large',\n    'big',\n    'huge',\n    'massive',\n    'normal',\n  ]),\n  textFieldName: PropTypes.string,\n  validate: PropTypes.arrayOf(PropTypes.func),\n  valueFieldName: PropTypes.string,\n  apiKey: PropTypes.string,\n};\n\nAsnycDropdownField.defaultProps = {\n  validate: [],\n  clearable: false,\n  label: '',\n  readOnly: false,\n  className: '',\n  fluid: false,\n  search: false,\n  multiple: false,\n  icon: 'dropdown',\n  size: 'normal',\n  disabled: false,\n  isRequired: false,\n  onAddNew: null,\n  onChange: null,\n  onSearch: null,\n  searchBy: null,\n  placeholder: '',\n  keyFieldName: 'key',\n  textFieldName: 'text',\n  valueFieldName: 'value',\n  apiKey: null,\n};\n\nexport default AsnycDropdownField;\n"],"file":"AsyncDropdownField.js"}