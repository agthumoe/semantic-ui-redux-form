{"version":3,"sources":["../../src/components/AsyncDropdownField.jsx"],"names":["renderField","fields","id","label","placeholder","loading","disabled","readOnly","className","fluid","icon","multiple","size","search","handleOnSearch","handleOnChange","input","data","allowAdditions","meta","touched","error","undefined","event","d","onChange","value","e","v","AsnycDropdownField","validate","name","isRequired","searchBy","onSearch","onAddNew","keyFieldName","valueFieldName","textFieldName","api","newValidator","slice","push","required","setData","setLoading","fetch","then","response","json","_","map","x","key","text","target","propTypes","PropTypes","string","bool","oneOfType","element","func","oneOf","arrayOf","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Dropdown, Form } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\nimport { Field } from 'redux-form';\nimport _ from 'lodash';\nimport { required } from './validation';\n\nconst renderField = (fields) => {\n  const {\n    id,\n    label,\n    placeholder,\n    loading,\n    disabled,\n    readOnly,\n    className,\n    fluid,\n    icon,\n    multiple,\n    size,\n    search,\n    handleOnSearch,\n    handleOnChange,\n    input,\n    data,\n    allowAdditions,\n    meta: { touched, error },\n  } = fields;\n\n  return (\n    <Form.Field className={className} error={touched && error && true}>\n      {label && (\n        <label htmlFor={id}>\n          {label}\n          <small>{touched && error ? `* ( ${error} )` : undefined}</small>\n        </label>\n      )}\n      <Dropdown\n        allowAdditions={allowAdditions}\n        disabled={disabled}\n        fluid={fluid}\n        icon={icon}\n        loading={loading}\n        multiple={multiple}\n        onChange={(event, d) => {\n          if (typeof handleOnChange === 'function') {\n            handleOnChange(event, d);\n          }\n          if (multiple) {\n            input.onChange([...d.value]);\n          } else {\n            input.onChange(d.value);\n          }\n        }}\n        onSearchChange={(e, v) => {\n          handleOnSearch(e, v);\n        }}\n        options={data}\n        placeholder={placeholder}\n        readOnly={readOnly}\n        search={!!search}\n        selection\n        size={size}\n        value={input.value}\n      />\n    </Form.Field>\n  );\n};\n\nconst AsnycDropdownField = ({\n  validate,\n  id,\n  name,\n  label,\n  placeholder,\n  isRequired,\n  disabled,\n  readOnly,\n  className,\n  fluid,\n  icon,\n  size,\n  search,\n  multiple,\n  searchBy,\n  onSearch,\n  onAddNew,\n  onChange,\n  keyFieldName,\n  valueFieldName,\n  textFieldName,\n  api,\n}) => {\n  const newValidator = validate.slice();\n  if (isRequired) {\n    newValidator.push(required);\n  }\n\n  const [data, setData] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    setLoading(true);\n    fetch(api)\n      .then(response => response.json())\n      .then((response) => {\n        setLoading(false);\n        setData(\n          _.map(response, x => ({\n            key: x[keyFieldName],\n            text: x[textFieldName],\n            value: x[valueFieldName],\n          })),\n        );\n      });\n  }, [keyFieldName, textFieldName, valueFieldName, api]);\n\n  return (\n    <Field\n      allowAdditions={typeof onAddNew === 'function'}\n      className={className}\n      component={renderField}\n      data={data}\n      disabled={disabled}\n      fluid={fluid}\n      handleOnAddNew={onAddNew}\n      handleOnChange={onChange}\n      handleOnSearch={(e, v) => {\n        if (typeof onSearch === 'function') {\n          onSearch(e, v);\n        }\n        if (searchBy && e.target.value) {\n          setLoading(true);\n          fetch(`${api}?${searchBy}=${e.target.value}`)\n            .then(response => response.json())\n            .then((response) => {\n              setLoading(false);\n              setData(\n                _.map(response, x => ({\n                  key: x[keyFieldName],\n                  text: x[textFieldName],\n                  value: x[valueFieldName],\n                })),\n              );\n            });\n        }\n      }}\n      icon={icon}\n      id={id}\n      label={label}\n      loading={loading}\n      multiple={multiple}\n      name={name}\n      placeholder={placeholder}\n      readOnly={readOnly}\n      search={search || searchBy || false}\n      size={size}\n      validate={newValidator}\n    />\n  );\n};\n\nAsnycDropdownField.propTypes = {\n  api: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  disabled: PropTypes.bool,\n  fluid: PropTypes.bool,\n  icon: PropTypes.string,\n  id: PropTypes.string.isRequired,\n  isRequired: PropTypes.bool,\n  keyFieldName: PropTypes.string,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.element]),\n  multiple: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onAddNew: PropTypes.func,\n  onChange: PropTypes.func,\n  onSearch: PropTypes.func,\n  placeholder: PropTypes.string,\n  readOnly: PropTypes.bool,\n  search: PropTypes.bool,\n  searchBy: PropTypes.string,\n  size: PropTypes.oneOf([\n    'mini',\n    'small',\n    'large',\n    'big',\n    'huge',\n    'massive',\n    'normal',\n  ]),\n  textFieldName: PropTypes.string,\n  validate: PropTypes.arrayOf(PropTypes.func),\n  valueFieldName: PropTypes.string,\n};\n\nAsnycDropdownField.defaultProps = {\n  validate: [],\n  label: '',\n  readOnly: false,\n  className: '',\n  fluid: false,\n  search: false,\n  multiple: false,\n  icon: 'dropdown',\n  size: 'normal',\n  disabled: false,\n  isRequired: false,\n  onAddNew: null,\n  onChange: null,\n  onSearch: null,\n  searchBy: null,\n  placeholder: '',\n  keyFieldName: 'key',\n  textFieldName: 'text',\n  valueFieldName: 'value',\n};\n\nexport default AsnycDropdownField;\n"],"file":"AsyncDropdownField.js"}